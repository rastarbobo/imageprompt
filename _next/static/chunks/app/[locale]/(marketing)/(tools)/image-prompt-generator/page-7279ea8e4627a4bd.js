(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3683],{61026:function(e,t,r){Promise.resolve().then(r.bind(r,73809)),Promise.resolve().then(r.bind(r,42638)),Promise.resolve().then(r.bind(r,30164)),Promise.resolve().then(r.bind(r,72476)),Promise.resolve().then(r.bind(r,15057)),Promise.resolve().then(r.bind(r,80190)),Promise.resolve().then(r.bind(r,41299)),Promise.resolve().then(r.t.bind(r,23993,23))},73809:function(e,t,r){"use strict";r.d(t,{default:function(){return y}});var a=r(83009),s=r(45291),n=r(16686),i=r(94230),o=r(70415),l=r(55183),c=r(27052),d=r(59400),m=r(13217),p=r(83512),u=r(60846),h=r(80229),x=r(7011),g=r(41677),A=r(45676),b=r(44834),f=r(40496);function y(e){let{currentURL:t,userId:r}=e,y=(0,h.useTranslations)(),{trackEvent:j}=(0,x.z)(),{trackUmamiEvent:w}=(0,g.M)(),[N,v]=(0,s.useState)(""),[P,C]=(0,s.useState)([""]),[_,E]=(0,s.useState)(0),[T,k]=(0,s.useState)(!1),[S,Z]=(0,s.useState)(""),[U,B]=(0,s.useState)(!1),[G,O]=(0,s.useState)("en"),[I,W]=(0,s.useState)("idle"),[M,R]=(0,s.useState)(null),F=(0,h.useLocale)(),z=(0,n.useRouter)(),[L,J]=(0,s.useState)({enhance:!1,edit:!1,translate:!1}),[D,H]=(0,s.useState)(!1),Q=P[_],V=(0,s.useCallback)(e=>{C(t=>[...t.slice(0,_+1),e]),E(e=>e+1)},[_]),Y=(0,s.useCallback)(()=>{_>0&&E(e=>e-1)},[_]),K=(0,s.useCallback)(()=>{_<P.length-1&&E(e=>e+1)},[_,P.length]),q=(0,s.useCallback)(()=>{if(!r){var e;let t=parseInt(null!==(e=localStorage.getItem("promptGenerationCount"))&&void 0!==e?e:"0");if(t>=3)return H(!0),j("show_login_prompt_generator",{reason:"rate_limit_exceeded_by_client"}),w("show_login_prompt_generator",{reason:"rate_limit_exceeded_by_client"}),!1;localStorage.setItem("promptGenerationCount",(t+1).toString())}return!0},[r,j,w]),X=async()=>{if(q()){J(e=>({...e,enhance:!0})),R(null),j("magic_enhance_prompt_generator"),w("magic_enhance_prompt_generator");try{let e=await fetch("/api/ai/prompts/magic-enhance",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userPrompt:N,page:"image-prompt-generator"})});if(!e.ok)throw Error("Failed to enhance prompt");let t=await e.json();V(t.prompt.trim())}catch(e){console.error("Error in Magic Enhance action:",e),w("[ERROR]magic_enhance_prompt_generator",{error:e instanceof Error?e.message:"Unknown error"}),R("An error occurred while enhancing the prompt. Please try again.")}finally{J(e=>({...e,enhance:!1}))}}},$=async()=>{if(!Q)return;sessionStorage.setItem("storedPrompt",Q);let e="en"===F?"/ai-image-generator?referrerPage=image-to-prompt":"/".concat(F,"/ai-image-generator?referrerPage=image-to-prompt");z.push(e)},ee=async()=>{if(q()){J(e=>({...e,edit:!0})),k(!1),j("edit_with_ai"),w("edit_with_ai");try{let e=await fetch("/api/ai/prompts/edit-with-ai",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userPrompt:N,editDetails:S})});if(!e.ok)throw Error("API request failed");let t=await e.json();V(t.prompt.trim())}catch(e){console.error("Error in edit with AI action:",e)}finally{J(e=>({...e,edit:!1}))}}},et=async()=>{if(q()){J(e=>({...e,translate:!0})),B(!1),j("translate_prompt_generator",{targetLanguage:G}),w("translate_prompt_generator");try{let e=await fetch("/api/ai/prompts/translate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userPrompt:N,targetLanguage:G,page:"image-prompt-generator"})});if(!e.ok)throw Error("API request failed");let t=await e.json();V(t.prompt.trim())}catch(e){console.error("Error in translate action:",e)}finally{J(e=>({...e,translate:!1}))}}},er=(0,s.useCallback)(async()=>{try{j("copy_image_prompt_generator"),await navigator.clipboard.writeText(Q),W("success"),setTimeout(()=>W("idle"),2e3)}catch(e){console.error("复制到剪贴板失败:",e),W("error"),setTimeout(()=>W("idle"),2e3)}},[Q,j]);return(0,a.jsxs)("div",{className:"min-h-[200px] px-4 sm:px-4 space-y-4",children:[(0,a.jsxs)("div",{className:"flex bg-muted rounded p-6 flex-col md:flex-row md:items-stretch md:space-x-4 space-y-4 md:space-y-0",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("div",{className:"mb-2",children:(0,a.jsx)("h2",{className:"text-lg font-semibold",children:y("common.keywords.promptCapital")})}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("textarea",{value:N,onChange:e=>{let t=e.target.value;if(t.length>2e3){R(y("imagePromptGenerator.errorTooLong"));return}R(null),v(t)},placeholder:y("imagePromptGenerator.inputPromptPlaceholder"),className:"w-full h-64 border bg-muted text-muted-foreground border-textarea rounded focus:ring-2 focus:ring-purple-500 resize-none p-2 ".concat(L.enhance||L.edit||L.translate?"opacity-50":""),rows:6,disabled:L.enhance||L.edit||L.translate}),(L.enhance||L.edit||L.translate)&&(0,a.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-muted bg-opacity-50",children:(0,a.jsx)(i.Z,{className:"w-6 h-6 animate-spin text-primary"})})]}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-2 mt-2",children:[(0,a.jsxs)("button",{onClick:X,disabled:L.enhance||!N.trim(),className:"px-2 py-1 text-primary border border-primary rounded disabled:opacity-50 text-sm flex items-center gap-2",children:[L.enhance?(0,a.jsx)(i.Z,{className:"w-4 h-4 animate-spin"}):(0,a.jsx)(o.Z,{className:"size-4"}),(0,a.jsx)("span",{children:y("imagePromptGenerator.magicEnhance")})]}),(0,a.jsxs)("button",{onClick:()=>k(!0),disabled:L.edit,className:"px-2 py-1 text-primary border border-primary rounded disabled:opacity-50 text-sm flex items-center gap-2",children:[L.edit?(0,a.jsx)(i.Z,{className:"w-4 h-4 animate-spin"}):(0,a.jsx)(l.Z,{className:"size-4"}),(0,a.jsx)("span",{children:y("imagePromptGenerator.editWithAI")})]}),(0,a.jsxs)("button",{onClick:()=>B(!0),disabled:L.translate,className:"px-2 py-1 text-primary border border-primary rounded disabled:opacity-50 text-sm flex items-center gap-2",children:[L.translate?(0,a.jsx)(i.Z,{className:"w-4 h-4 animate-spin"}):(0,a.jsx)(c.Z,{className:"size-4"}),(0,a.jsx)("span",{children:y("imagePromptGenerator.translate")})]}),(0,a.jsx)("div",{className:"mt-2 flex justify-between items-center text-sm",children:M&&(0,a.jsx)("div",{className:"text-red-500",children:M})})]})]}),(0,a.jsx)("div",{className:"hidden md:flex items-center justify-center text-3xl font-bold text-primary",children:(0,a.jsx)("span",{children:">>"})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"mb-2 flex items-center justify-between",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold",children:y("imagePromptGenerator.result")}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)("button",{onClick:Y,disabled:_<=1||L.enhance,className:"px-2 py-1 text-muted-foreground border border-muted-foreground rounded disabled:opacity-50 text-sm",children:(0,a.jsx)(d.Z,{className:"size-4"})}),(0,a.jsx)("button",{onClick:K,disabled:_===P.length-1||L.enhance,className:"px-2 py-1 text-muted-foreground border border-muted-foreground rounded disabled:opacity-50 text-sm",children:(0,a.jsx)(m.Z,{className:"size-4"})})]})]}),(0,a.jsx)("div",{className:"relative",children:(0,a.jsx)("textarea",{value:Q,readOnly:!0,className:"w-full h-64 border bg-muted text-muted-foreground border-textarea rounded p-2 resize-none mb-2",placeholder:y("imagePromptGenerator.resultPlaceholder")})}),Q&&(0,a.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,a.jsxs)("button",{onClick:()=>{j("continue_editing"),w("continue_editing"),v(Q)},disabled:L.enhance,className:"px-2 py-1 text-primary border border-primary rounded disabled:opacity-50 text-sm flex items-center gap-2",children:[(0,a.jsx)(p.Z,{className:"size-4"}),(0,a.jsx)("span",{children:y("imagePromptGenerator.continueEditing")})]}),(0,a.jsxs)("button",{onClick:er,className:"px-2 py-1 text-primary border border-primary rounded disabled:opacity-50 text-sm flex items-center gap-2",disabled:L.enhance||"success"===I,children:[(0,a.jsx)(u.Z,{className:"size-4"}),(0,a.jsxs)("span",{children:["idle"===I&&y("imageToPrompt.copyPrompt"),"success"===I&&y("imageToPrompt.copied"),"error"===I&&y("common.copyFailed")]})]})]}),Q&&(0,a.jsx)("button",{onClick:$,disabled:""===Q,className:"w-full px-6 py-2 bg-[#7F00FF] text-white rounded hover:bg-purple-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition duration-300 ease-in-out text-xl font-bold",children:y("common.generateImage")})]})]}),T&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,a.jsxs)("div",{className:"bg-card p-6 rounded w-full max-w-md",children:[(0,a.jsx)("h2",{className:"text-xl font-bold mb-4",children:y("imagePromptGenerator.editWithAI")}),(0,a.jsxs)("p",{className:"mb-2 text-sm text-muted-foreground",children:[y("imagePromptGenerator.howToUse.editWithAI.example"),': "',(0,a.jsx)("span",{className:"text-primary italic",children:y("imagePromptGenerator.howToUse.editWithAI.example1")}),'" or "',(0,a.jsx)("span",{className:"text-primary italic",children:y("imagePromptGenerator.howToUse.editWithAI.example2")}),'" or "',(0,a.jsx)("span",{className:"text-primary italic",children:y("imagePromptGenerator.howToUse.editWithAI.example3")}),'"']}),(0,a.jsx)("textarea",{value:S,onChange:e=>Z(e.target.value),placeholder:y("imagePromptGenerator.howToUse.editWithAI.placeholder"),className:"w-full p-2 border rounded mb-4 h-36 resize-none text-muted-foreground bg-muted",rows:4}),(0,a.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,a.jsx)("button",{onClick:()=>k(!1),className:"px-4 py-2 bg-s rounded text-sm border",children:y("common.confirmation.cancel")}),(0,a.jsx)("button",{onClick:ee,disabled:!S.trim(),className:"px-4 py-2 bg-primary text-white rounded text-sm disabled:opacity-50 disabled:cursor-not-allowed",children:y("common.confirmation.confirm")})]})]})}),(0,a.jsx)(A.Z,{isOpen:U,onClose:()=>B(!1),onConfirm:et,targetLanguage:G,onLanguageChange:e=>O(e)}),D&&(0,a.jsx)(f.u,{isOpen:D,onClose:()=>H(!1),children:(0,a.jsx)(b.LoginForm,{redirectToURL:t})})]})}},42638:function(e,t,r){"use strict";r.d(t,{default:function(){return d}});var a=r(83009),s=r(97528),n=r(16686),i=r(99251),o=r(22992),l=r(80229);let c=[{name:"imageToPromptCapital",href:"/image-to-prompt",icon:i.Z},{name:"textToPromptCapital",href:"/image-prompt-generator",icon:o.Z}];function d(){let e=(0,n.usePathname)(),t=(0,l.useTranslations)("common.keywords"),r=t=>{let r=e.replace(/^\/|\/$/g,""),a=t.replace(/^\/|\/$/g,""),s=r.split("/");return s[s.length-1]===a};return(0,a.jsx)("div",{className:"w-full px-4 sm:px-0 sm:inline-block",children:(0,a.jsx)("nav",{className:"flex space-x-1 px-0 sm:px-4","aria-label":"Tabs",children:c.map((e,n)=>(0,a.jsxs)(s.rU,{href:e.href,className:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter(Boolean).join(" ")}("flex items-center py-4 px-1 sm:px-8 text-sm sm:text-base flex-1 sm:flex-none justify-center whitespace-nowrap","text-adaptive",r(e.href)?"bg-muted text-primary border-b-2 border-primary font-bold":"text-gray-500 hover:text-gray-700 font-medium",0===n?"rounded-tl-md":"",n===c.length-1?"rounded-tr-md":""),"aria-current":r(e.href)?"page":void 0,children:[(0,a.jsx)(e.icon,{className:"w-4 h-4 sm:w-5 sm:h-5 mr-0.5 sm:mr-2 flex-shrink-0",strokeWidth:r(e.href)?2.5:2}),(0,a.jsx)("span",{className:"text-adaptive",children:t(e.name)})]},e.name))})})}},72476:function(e,t){"use strict";t.default={src:"/_next/static/media/edit-with-ai-feature.11bcd346.png",height:360,width:576,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAFCAMAAABPT11nAAAANlBMVEWMHvbdwvn09PTZuvno3vTBiffu3/rfx/bt2v/+/v7x6/fe1eenXu3Xr//28P/HoPLc0eb36v82KwMjAAAAEXRSTlMeePlXjDuXZI39s/UqU5131NNN7O8AAAAJcEhZcwAACxMAAAsTAQCanBgAAAAtSURBVHicFcGFEQAgDASwr1HB91+WI4E01YEBaDLT6QRzl91vwKuWZwY+izYfFqwBCxiGRg0AAAAASUVORK5CYII=",blurWidth:8,blurHeight:5}},15057:function(e,t){"use strict";t.default={src:"/_next/static/media/magic-enhance-feature.51646ad3.png",height:360,width:576,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAFCAMAAABPT11nAAAASFBMVEWFCf/k0Prn6ObVyONkAPjZuPoAJO6MJurn4uzw4v/z6f3Qr/H06v/o3fNoAP/Z2djn3vDMsOjW0eW/f//c2OGFOdDLvNv6+/mLBiNWAAAAF3RSTlMagfyWE1QHIOmNnE2SiBb4r2WsMNksisDTgsUAAAAJcEhZcwAACxMAAAsTAQCanBgAAAAySURBVHicY2Dl4uEUZhdlZ+DmZeTgEOFgZGBhYxNi4hfnZGBgZxEQZwIxGPgEmcWYWQEjLAGIoylM0AAAAABJRU5ErkJggg==",blurWidth:8,blurHeight:5}},80190:function(e,t){"use strict";t.default={src:"/_next/static/media/translate-feature.3d6e2b8a.png",height:360,width:576,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAFCAMAAABPT11nAAAAM1BMVEWPHP9oAPrSs/WBLeDYtfzm1/P49/jt3vsgFfXeyu+/ev/g3eLJpu3bv/rx4P/b1OT+//41cNDZAAAAEHRSTlMdFnElUIr7jwh6MPRIdJfTuClnngAAAAlwSFlzAAALEwAACxMBAJqcGAAAAC1JREFUeJwFwYcBACAMwKConc7+f62AuOpkDLzKzlvJzux9mdIiQqwcoE2/8gEZ5QEZZYQJCwAAAABJRU5ErkJggg==",blurWidth:8,blurHeight:5}}},function(e){e.O(0,[342,4434,6083,229,6587,4223,1960,6770,9453,5091,3768,6479,4335,1744],function(){return e(e.s=61026)}),_N_E=e.O()}]);