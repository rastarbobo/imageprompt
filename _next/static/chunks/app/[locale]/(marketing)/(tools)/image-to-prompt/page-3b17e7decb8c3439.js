(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4518],{8249:function(e,t,r){Promise.resolve().then(r.bind(r,45773)),Promise.resolve().then(r.bind(r,42638)),Promise.resolve().then(r.bind(r,30164)),Promise.resolve().then(r.bind(r,68779)),Promise.resolve().then(r.bind(r,88999)),Promise.resolve().then(r.bind(r,41299)),Promise.resolve().then(r.t.bind(r,23993,23))},45773:function(e,t,r){"use strict";r.d(t,{default:function(){return P}});var a=r(83009),l=r(45291),s=r(79809),o=r(99562),n=r(7011),i=r(41677),d=r(16686),m=r(60846),c=r(80229),p=r(44834),u=r(40496),x=r(51138),g=r(98599),h=r(98997),f=r(79735),b=r(97166),y=r(26892),w=r(94721),v=r(31009),j=r(19375),N=r(11138),_=r(18498),k=r(97528);function P(e){var t;let{currentURL:r,userId:P}=e,L=(0,c.useTranslations)("imageToPrompt"),C=(0,c.useTranslations)(),[U,R]=(0,l.useState)(null),[S,E]=(0,l.useState)(null),[I,T]=(0,l.useState)(!1),[M,Z]=(0,l.useState)(!1),[F,A]=(0,l.useState)(null),[O,H]=(0,l.useState)(!1),[B,z]=(0,l.useState)(x.cs.GENERAL),[W,D]=(0,l.useState)("en"),[G,V]=(0,l.useState)(!1),[q,J]=(0,l.useState)(!1),{trackEvent:$}=(0,n.z)(),{trackUmamiEvent:K}=(0,i.M)(),X=(0,d.useRouter)(),Q=(0,c.useLocale)(),[Y,ee]=(0,l.useState)({dailyUsage:0,dailyLimit:-1,packsBalance:[]}),et=(0,l.useCallback)(async()=>{if(P)try{let e=await (0,v.Gu)(P);console.log("balance",e),ee(e)}catch(e){console.error("Error fetching usage stats:",e)}},[P]);(0,l.useEffect)(()=>{et()},[et,P]);let er=async()=>{if(!S)return;sessionStorage.setItem("storedPrompt",S.prompt);let e="en"===Q?"/ai-image-generator?referrerPage=image-to-prompt":"/".concat(Q,"/ai-image-generator?referrerPage=image-to-prompt");X.push(e)},ea=async()=>{if(U){if(!P){var e;let t=parseInt(null!==(e=localStorage.getItem("promptGenerationCount"))&&void 0!==e?e:"0");if(t>=3){H(!0),$("show_login_image_to_prompt",{reason:"rate_limit_exceeded_by_client"}),K("show_login_image_to_prompt",{reason:"rate_limit_exceeded_by_client"});return}localStorage.setItem("promptGenerationCount",(t+1).toString())}T(!0),A(null);try{$("image_to_prompt",{image_model:B,prompt_language:W}),K("image_to_prompt",{image_model:B,prompt_language:W});let e=await (0,o.SN)(U,B,W);E(e),e.prompt&&b.a.addHistory({id:(0,y.Z)(),prompt:e.prompt,modelId:B,language:W,timestamp:Date.now()},null!=P?P:void 0),await et()}catch(e){e instanceof Error?"UnauthorizedError"===e.name?(H(!0),$("show_login_image_to_prompt",{reason:"rate_limit_exceeded_by_ip"}),K("show_login_image_to_prompt",{reason:"rate_limit_exceeded_by_ip"})):(console.error("Error generating prompt:",e),A(e.message||"An error occurred while generating the prompt"),e.message.includes("inappropriate")?K("image_to_prompt_blocked",{}):K("[ERROR]image_to_prompt",{error_message:e.message||"An error occurred while generating the prompt"})):(console.error("Unknown error:",e),A("An unknown error occurred"),K("[ERROR]image_to_prompt",{error_message:"An unknown error occurred"}))}finally{T(!1)}}};return(0,a.jsxs)("div",{className:"container mx-auto px-4 max-w-6xl",children:[O&&(0,a.jsx)(u.u,{isOpen:O,onClose:()=>H(!1),children:(0,a.jsx)(p.LoginForm,{redirectToURL:r})}),q&&(0,a.jsx)(u.u,{isOpen:q,maxWidth:"max-w-lg",onClose:()=>J(!1),children:(0,a.jsx)(N.K,{resetTime:(0,j.EJ)(),onClose:()=>J(!1)})}),G&&(0,a.jsx)(u.u,{isOpen:G,onClose:()=>V(!1),maxWidth:"max-w-4xl",children:(0,a.jsxs)("div",{className:"p-2",children:[(0,a.jsx)("h2",{className:"text-xl font-bold mb-2",children:L("promptHistory.promptHistory")}),(0,a.jsx)(f.s,{userId:null!=P?P:void 0})]})}),(0,a.jsx)("div",{className:"rounded overflow-hidden",children:(0,a.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,a.jsxs)("div",{className:"w-full bg-muted rounded p-4",children:[(0,a.jsx)(s.Z,{onImageUpload:e=>{R(e),E(null),A(null),e&&P&&!(0,j.BA)(Y)&&(console.log("daily limit reached"),K("daily_limit_reached_modal_shown",{daily_limit:Y.dailyLimit}),J(!0))}}),(0,a.jsxs)("div",{className:"flex flex-col items-start py-2 md:py-4",children:[(0,a.jsx)("div",{className:"w-full px-0 md:px-4",children:(0,a.jsx)("hr",{className:"w-full my-2 md:my-4 border-t border-gray/10"})}),(0,a.jsx)(g.Z,{onModelChange:e=>{z(e)}}),(0,a.jsx)("div",{className:"flex flex-col sm:flex-row justify-start items-center gap-4 mt-4 w-full px-0 md:px-4",children:(0,a.jsxs)("div",{className:"w-full flex items-center space-x-2",children:[(0,a.jsx)("label",{htmlFor:"promptLanguage",className:"text-base font-semibold leading-6 text-foreground whitespace-nowrap",children:L("promptLanguage")}),(0,a.jsx)(h.Z,{value:W,onChange:e=>{D(e)},className:"flex-grow max-w-[300px]"})]})}),"en"!==W&&(0,a.jsx)("div",{className:"mt-4 px-4 bg-muted rounded",children:(0,a.jsx)("p",{className:"text-xs text-muted-foreground text-center italic",children:L("englishPromptRecommendation")})}),(0,a.jsxs)("div",{className:"flex flex-col items-center gap-2 md:gap-4 mt-6 px-0 sm:flex-row md:px-4 w-full md:w-auto",children:[(0,a.jsx)("div",{className:"w-full flex items-center sm:items-center sm:justify-start gap-4",children:(0,a.jsx)("button",{onClick:ea,disabled:!U||I||!!P&&Y&&!(0,j.BA)(Y),className:"w-full sm:w-auto px-4 md:px-6 py-2 bg-[#7F00FF] text-white rounded hover:bg-purple-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition duration-300 ease-in-out text-2xl font-bold flex items-center justify-center",children:I?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),L("generatingPrompt")]}):L("generatePrompt")})}),P&&(0,a.jsx)(w.l,{balance:Y,nextResetTime:(0,j.EJ)()}),(0,a.jsx)("button",{onClick:()=>{K("view_prompt_history"),V(!0)},className:"text-primary text-sm hover:underline hover:text-primary transition-colors whitespace-nowrap",children:L("promptHistory.viewHistory")})]}),F&&(0,a.jsx)("div",{className:"px-4 mt-2 text-red-500 text-center",children:F})]}),(0,a.jsxs)("div",{className:"px-0 md:px-4 relative",children:[(0,a.jsx)("textarea",{value:null!==(t=null==S?void 0:S.prompt)&&void 0!==t?t:L("generatedPromptPlaceholder"),className:"w-full h-36 p-2 border border-border bg-background text-muted-foreground placeholder:text-gray-300 rounded focus:outline-none focus:ring-0 focus:border-primary resize-none pr-10",rows:6,readOnly:!0}),S&&(0,a.jsx)("button",{onClick:()=>{S&&($("image_to_prompt_copy",{image_model:B,prompt_language:W}),navigator.clipboard.writeText(S.prompt).then(()=>{Z(!0),setTimeout(()=>Z(!1),2e3)}).catch(e=>console.error("Copy failed:",e)))},className:"absolute top-2 right-6 p-1 text-gray-500 hover:text-purple-700 transition duration-300 ease-in-out",title:L(M?"copied":"copyPrompt"),children:M?L("copied"):(0,a.jsx)(m.Z,{className:"h-5 w-5"})}),(B===x.cs.FLUX||B===x.cs.GENERAL)&&S&&(0,a.jsx)("div",{className:"flex flex-col items-center sm:items-start py-4",children:(0,a.jsx)("button",{onClick:er,disabled:null===S,className:"w-full md:w-auto px-6 py-2 bg-muted text-primary rounded border border-primary hover:bg-purple-700 hover:text-white disabled:cursor-not-allowed transition duration-300 ease-in-out text-2xl font-bold",children:L("generateImage")})})]})]}),(0,a.jsx)("div",{className:"w-full rounded p-4 bg-yellow-50 dark:bg-muted text-center",children:(0,a.jsx)("p",{className:"text-muted-foreground",children:L.rich("describePrompt",{Link:()=>(0,a.jsx)(k.rU,{href:"/describe-image",className:"text-blue-600 hover:underline font-bold",children:C("common.menu.describeImage")})})})}),(0,a.jsx)(_.u,{})]})})]})}},79809:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}});var a=r(83009),l=r(45291),s=r(80229),o=r(6335),n=r(94230);function i(e){let{onImageUpload:t}=e,r=(0,s.useTranslations)("imageToPrompt"),[i,d]=(0,l.useState)(""),[m,c]=(0,l.useState)(""),[p,u]=(0,l.useState)(!1),[x,g]=(0,l.useState)(null),[h,f]=(0,l.useState)(null),[b,y]=(0,l.useState)("upload"),w=async()=>{if(k(),i){let e=await _(i);console.log("base64Url",e),e&&(c(i),t(e))}},v=async e=>{var r;let a=null===(r=e.target.files)||void 0===r?void 0:r[0];if(a){k();try{let e=await N(a),r=URL.createObjectURL(a);c(r),t(e)}catch(e){console.error("Error uploading file:",e),f(e.message)}}},j=async e=>{var r;e.preventDefault(),e.stopPropagation(),k();let a=null===(r=e.dataTransfer.files)||void 0===r?void 0:r[0];if(null==a?void 0:a.type.startsWith("image/"))try{let e=await N(a),r=URL.createObjectURL(a);c(r),t(e)}catch(e){console.error("Error uploading file:",e),f(e.message)}},N=async e=>{let t;if(e)t=await (0,o.tg)(e,600,600);else throw Error("File is required");return await (0,o.w8)(t)},_=async e=>{try{new URL(e)}catch(e){g("Please enter a valid URL");return}u(!0);try{let t="/api/image/proxy?url=".concat(encodeURIComponent(e)),r=await fetch(t);if(!r.ok)throw Error("Failed to fetch image from URL, please try to download it first.");let a=await r.blob(),l=await (0,o.tg)(a,600,600);return await (0,o.w8)(l)}catch(e){console.error("Error loading image from URL:",e),g(e.message)}finally{u(!1)}},k=()=>{c(""),g(null),f(null),t("")};return(0,a.jsxs)("div",{className:"flex flex-col md:flex-row gap-4 md:gap-8",children:[(0,a.jsxs)("div",{className:"w-full md:w-1/2 flex flex-col",children:[(0,a.jsxs)("div",{className:"flex gap-1 mb-4 pl-0 md:pl-4",children:[(0,a.jsx)("button",{onClick:()=>y("upload"),className:"px-6 py-2 rounded text-sm md:text-base transition-colors\n              ".concat("upload"===b?"bg-primary/20 text-primary font-semibold":"text-gray-500 hover:text-gray-700"),children:r("uploadImageTitle")}),(0,a.jsx)("button",{onClick:()=>y("url"),className:"px-6 py-2 rounded text-sm md:text-base transition-colors\n              ".concat("url"===b?"bg-primary/20 text-primary font-semibold":"text-gray-500 hover:text-gray-700"),children:r("inputImageUrlTitle")})]}),(0,a.jsxs)("div",{className:"space-y-6 flex-grow flex flex-col",children:["upload"===b&&(0,a.jsxs)("div",{className:"pl-0 md:pl-4 rounded flex-grow",children:[(0,a.jsxs)("label",{htmlFor:"file-upload",className:"flex items-center justify-center h-48 bg-secondary rounded border border-dashed border-gray-400 cursor-pointer",onDragOver:e=>{e.preventDefault(),e.stopPropagation()},onDrop:j,children:[(0,a.jsx)("input",{id:"file-upload",type:"file",accept:"image/*",onChange:v,className:"hidden","aria-label":"Upload image file"}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("svg",{className:"mx-auto h-12 w-12 text-purple-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),(0,a.jsx)("p",{className:"mt-1 text-sm text-secondary-foreground",children:r("uploadImageInstruction")}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:r("uploadImageFormats")})]})]}),h&&(0,a.jsx)("div",{className:"text-red-500 text-sm mt-2",children:h})]}),"url"===b&&(0,a.jsx)("div",{className:"pl-0 md:pl-4",children:(0,a.jsxs)("div",{className:"",children:[(0,a.jsx)("label",{htmlFor:"image-url",className:"sr-only",children:"Image URL"}),(0,a.jsx)("input",{id:"image-url",type:"text",value:i,onChange:e=>{d(e.target.value)},placeholder:r("inputImageUrlPlaceholder"),className:"w-full px-2 border border-border bg-background text-muted-foreground rounded focus:outline-none focus:ring-0 focus:border-primary"}),(0,a.jsx)("button",{onClick:w,disabled:p||!i,className:"\n                    w-auto px-4 my-4 py-2 text-sm rounded transition duration-300\n                    ".concat(p||!i?"bg-gray-100 text-gray-400 border border-gray-300 cursor-not-allowed":"bg-muted text-primary border border-primary hover:bg-primary/20","\n                  "),children:p?(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(n.Z,{className:"w-4 h-4 animate-spin"}),r("loadImageUrlButton")]}):r("loadImageUrlButton")}),x&&(0,a.jsx)("div",{className:"text-red-500 text-sm",children:x})]})})]})]}),(0,a.jsxs)("div",{className:"w-full md:w-1/2 flex flex-col order-last md:pr-4",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold mb-2 md:mb-6",children:r("imagePreviewTitle")}),(0,a.jsx)("div",{className:"rounded flex-grow flex items-center justify-center bg-secondary h-48",children:m?(0,a.jsx)("img",{src:m,alt:r("imagePreviewAlt"),className:"max-w-full max-h-full object-contain"}):(0,a.jsxs)("div",{className:"text-center text-muted-foreground",children:[(0,a.jsx)("svg",{className:"mx-auto h-12 w-12",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),(0,a.jsx)("p",{className:"mt-1 text-sm text-muted-foreground",children:r("imagePreviewPlaceholder")})]})})]})]})}},42638:function(e,t,r){"use strict";r.d(t,{default:function(){return m}});var a=r(83009),l=r(97528),s=r(16686),o=r(99251),n=r(22992),i=r(80229);let d=[{name:"imageToPromptCapital",href:"/image-to-prompt",icon:o.Z},{name:"textToPromptCapital",href:"/image-prompt-generator",icon:n.Z}];function m(){let e=(0,s.usePathname)(),t=(0,i.useTranslations)("common.keywords"),r=t=>{let r=e.replace(/^\/|\/$/g,""),a=t.replace(/^\/|\/$/g,""),l=r.split("/");return l[l.length-1]===a};return(0,a.jsx)("div",{className:"w-full px-4 sm:px-0 sm:inline-block",children:(0,a.jsx)("nav",{className:"flex space-x-1 px-0 sm:px-4","aria-label":"Tabs",children:d.map((e,s)=>(0,a.jsxs)(l.rU,{href:e.href,className:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter(Boolean).join(" ")}("flex items-center py-4 px-1 sm:px-8 text-sm sm:text-base flex-1 sm:flex-none justify-center whitespace-nowrap","text-adaptive",r(e.href)?"bg-muted text-primary border-b-2 border-primary font-bold":"text-gray-500 hover:text-gray-700 font-medium",0===s?"rounded-tl-md":"",s===d.length-1?"rounded-tr-md":""),"aria-current":r(e.href)?"page":void 0,children:[(0,a.jsx)(e.icon,{className:"w-4 h-4 sm:w-5 sm:h-5 mr-0.5 sm:mr-2 flex-shrink-0",strokeWidth:r(e.href)?2.5:2}),(0,a.jsx)("span",{className:"text-adaptive",children:t(e.name)})]},e.name))})})}},99251:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.372.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r(69830).Z)("ImageUp",[["path",{d:"M10.3 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2v10l-3.1-3.1a2 2 0 0 0-2.814.014L6 21",key:"9csbqa"}],["path",{d:"m14 19.5 3-3 3 3",key:"9vmjn0"}],["path",{d:"M17 22v-5.5",key:"1aa6fl"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}]])},22992:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.372.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r(69830).Z)("NotebookPen",[["path",{d:"M13.4 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-7.4",key:"re6nr2"}],["path",{d:"M2 6h4",key:"aawbzj"}],["path",{d:"M2 10h4",key:"l0bgd4"}],["path",{d:"M2 14h4",key:"1gsvsf"}],["path",{d:"M2 18h4",key:"1bu2t1"}],["path",{d:"M18.4 2.6a2.17 2.17 0 0 1 3 3L16 11l-4 1 1-4Z",key:"1dba1m"}]])}},function(e){e.O(0,[8415,342,4434,6083,229,6587,4223,1960,6770,7372,2776,3482,9453,5019,4738,943,8774,561,6479,4335,1744],function(){return e(e.s=8249)}),_N_E=e.O()}]);